<view class="page-wrapper">
  <scroll-view class="content" scroll-y="true">
    <!-- 订单状态模块 -->
    <view class="status-box">
      <text class="status-text">{{order.status_text}}</text>
      <text class="status-desc">{{order.status_desc}}</text>
    </view>

    <!-- 商品列表 -->
    <view class="section-title">商品信息</view>
    <view class="product-list">
      <block wx:for="{{order.items}}" wx:key="id">
        <view class="product-item">
          <image class="product-img" src="{{item.product_image}}"></image>
          <view class="product-info">
            <text class="product-name">{{item.product_name}}</text>
            <text class="product-spec">{{item.spec}}</text>
            <view class="product-bottom">
              <text class="product-price">￥{{item.price}}</text>
              <text class="product-qty">x {{item.quantity}}</text>
            </view>
          </view>
        </view>
      </block>
    </view>

    <!-- 金额信息 -->
    <view class="section-title">金额详情</view>
    <view class="info-box">
      <view class="info-row">
        <text>商品总额</text>
        <text>￥{{order.total_amount}}</text>
      </view>
      <view class="info-row">
        <text>运费</text>
        <text>￥{{order.shipping_fee}}</text>
      </view>
      <view class="info-row">
        <text>优惠</text>
        <text>-￥{{order.discount_amount}}</text>
      </view>
      <view class="info-row total">
        <text>订单总计</text>
        <text class="total-price">￥{{order.pay_amount}}</text>
      </view>
    </view>

    <!-- 收货信息 -->
    <view class="section-title">收货信息</view>
    <view class="info-box">
      <view class="info-row">
        <text>收货人</text>
        <text>{{order.receiver_name}}</text>
      </view>
      <view class="info-row">
        <text>手机号</text>
        <text>{{order.receiver_phone}}</text>
      </view>
      <view class="info-row">
        <text>收货地址</text>
        <text class="address">{{order.receiver_address}}</text>
      </view>
    </view>

    <!-- 订单信息 -->
    <view class="section-title">订单信息</view>
    <view class="info-box">
      <view class="info-row">
        <text>订单编号</text>
        <text selectable="true">{{order.encrypted_id}}</text>
      </view>
      <view class="info-row">
        <text>下单时间</text>
        <text>{{order.created_at}}</text>
      </view>
      <view class="info-row">
        <text>支付方式</text>
        <text>{{order.payment_method}}</text>
      </view>
      <view class="info-row" wx:if="{{order.paid_at}}">
        <text>支付时间</text>
        <text>{{order.paid_at}}</text>
      </view>
    </view>
  </scroll-view>

  <view class="after-sale-btn" bindtap="goAfterSale" style="position: fixed; left: 0rpx; top: 1328rpx" wx:if="{{order.status=='paid'}}">
    联系售后客服
  </view>

  <!-- 底部操作按钮 -->
  <view class="bottom-btns">
    <button wx:if="{{order.status=='pending'}}" class="btn" type="primary" bindtap="payNow" style="position: relative; left: -20rpx; top: 20rpx">立即支付</button>
    <button wx:if="{{order.status=='pending'}}" class="btn cancel" bindtap="cancelOrder" style="position: relative; left: -20rpx; top: 20rpx">取消订单</button>

    <button wx:if="{{order.status=='shipped'}}" class="btn" type="primary" bindtap="viewLogistics">查看物流</button>
    <button wx:if="{{order.status=='completed'}}" class="btn" bindtap="goAfterSale">联系商家</button>
  </view>
</view>